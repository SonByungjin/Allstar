{"ast":null,"code":"var _jsxFileName = \"/home/user/\\uBC14\\uD0D5\\uD654\\uBA74/wecode/project/converse/12-Allstar-frontend/src/Pages/ProductList/ProductList.js\";\nimport React from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport FilterVerticalBar from \"./Components/FilterVerticalBar/FilterVerticalBar\";\nimport ProductContainer from \"./Components/ProductContainer/ProductContainer\";\nimport FilterHorizontalBar from \"./Components/FilterHorizontalBar/FilterHorizontalBar\";\nimport Footer from \"../../Components/Footer/Footer\";\nimport PromoBanner from \"../../Components/PromoBanner/PromoBanner\";\nimport Nav from \"../../Components/Nav/Nav\";\nimport HeaderImg from \"./HeaderImg\";\nimport \"./ProductList.scss\";\nexport class ProductList extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.getDataInitial = () => {\n      window.onbeforeunload = () => {\n        window.scrollTo(0, 0);\n      };\n\n      const categoryId = this.props.location.search.split(\"=\")[1];\n      this.setState({\n        loadingStatus: !this.state.loadingStatus,\n        products: [],\n        ProductMainImage: {\n          MainImg: []\n        }\n      }, () => {\n        // fetch(\"/data/ProductList/Products.json\")\n        fetch(`http://10.58.1.230:8000/products?sub_category_id=${categoryId}`).then(res => res.json()).then(res => {\n          // 무한스크롤 기능 확인을 위한 임의 함수\n          let result = res.products.slice(this.state.products.length, this.state.products.length + 14); // let result = res.products;\n\n          setTimeout(() => this.setState({\n            loadingStatus: !this.state.loadingStatus\n          }, () => {\n            this.setState({\n              wholeProducts: res.products,\n              products: [...this.state.products, ...result]\n            });\n          }), 1000);\n          window.addEventListener(\"scroll\", this.infiniteScroll);\n        });\n      });\n    };\n\n    this.infiniteScroll = e => {\n      let scrollHeight = Math.max(document.documentElement.scrollHeight, document.body.scrollHeight);\n      let scrollTop = Math.max(document.documentElement.scrollTop, document.body.scrollTop);\n      let clientHeight = document.documentElement.clientHeight;\n\n      if (scrollTop + clientHeight + 500 >= scrollHeight) {\n        this.pagination();\n        e.preventDefault();\n      }\n    };\n\n    this.pagination = () => {\n      var keys = {\n        37: 1,\n        38: 1,\n        39: 1,\n        40: 1\n      };\n      var wheelOpt = supportsPassive ? {\n        passive: false\n      } : false;\n      var wheelEvent = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : \"mousewheel\";\n\n      function preventDefault(e) {\n        e.preventDefault();\n      }\n\n      function preventDefaultForScrollKeys(e) {\n        if (keys[e.keyCode]) {\n          preventDefault(e);\n          return false;\n        }\n      }\n\n      window.addEventListener(wheelEvent, preventDefault, wheelOpt);\n      const {\n        wholeProducts,\n        products\n      } = this.state;\n\n      if (wholeProducts.length > products.length) {\n        this.setState({\n          loadingStatus: !this.state.loadingStatus\n        }, () => {\n          let result = wholeProducts.slice(products.length, products.length + 14);\n          setTimeout(() => this.setState({\n            loadingStatus: !this.state.loadingStatus\n          }, () => {\n            this.setState({\n              products: [...this.state.products, ...result]\n            }, () => {\n              window.removeEventListener(wheelEvent, preventDefault, wheelOpt);\n            });\n          }), 1000);\n        });\n      }\n    };\n\n    this.filterQueryString = () => {\n      const categoryId = this.props.location.search.split(\"=\")[1];\n      let filteringQueryStringApi = `http://10.58.1.230:8000/products?sub_category_id=${categoryId}&${this.state.filteringColor ? this.state.filteringColor.map(color => {\n        return `color=${color}&`;\n      }).join(\"\") : \"\"}${this.state.filteringSize ? this.state.filteringSize.map(size => {\n        return `size=${size}&`;\n      }).join(\"\") : \"\"}${this.state.filteringSilluet ? this.state.filteringSilluet.map(silluet => {\n        return `silouette=${silluet}&`;\n      }).join(\"\") : \"\"}`.slice(0, -1);\n      this.getfilteringData(filteringQueryStringApi);\n      console.log(filteringQueryStringApi);\n    };\n\n    this.getfilteringData = filteringQueryStringApi => {\n      window.onbeforeunload = () => {\n        window.scrollTo(0, 0);\n      };\n\n      this.setState({\n        loadingStatus: !this.state.loadingStatus,\n        products: [],\n        ProductMainImage: {\n          MainImg: []\n        }\n      }, () => {\n        fetch(filteringQueryStringApi).then(res => res.json()).then(res => {\n          console.log(res);\n          let result = res.products.slice(this.state.products.length, this.state.products.length + 14);\n          setTimeout(() => this.setState({\n            loadingStatus: !this.state.loadingStatus\n          }, () => {\n            this.setState({\n              wholeProducts: res.products,\n              products: result\n            });\n          }), 1000);\n          window.addEventListener(\"scroll\", this.infiniteScroll);\n        });\n      });\n    };\n\n    this.fixedImage = (colorEl, pdIdx) => {\n      let updateProductMainImage = this.state.ProductMainImage;\n      updateProductMainImage.MainImg[pdIdx].mainId = colorEl.id;\n      updateProductMainImage.MainImg[pdIdx].ImgUrl = colorEl.image_url;\n      this.setState({\n        ProductMainImage: updateProductMainImage\n      });\n    };\n\n    this.handleFilter = () => {\n      this.setState({\n        hideFilterVaild: !this.state.hideFilterVaild\n      });\n    };\n\n    this.filteringColor = Color => {\n      this.state.filteringColor.includes(Color) ? (() => {\n        let colorIdx = this.state.filteringColor.indexOf(Color);\n        const newArray = [...this.state.filteringColor];\n        newArray.splice(colorIdx, 1);\n        this.setState({\n          filteringColor: newArray\n        }, () => this.filterQueryString());\n      })() : this.setState({\n        filteringColor: [...this.state.filteringColor, Color]\n      }, () => this.filterQueryString());\n    };\n\n    this.filteringSize = size => {\n      this.state.filteringSize.includes(size) ? (() => {\n        let colorIdx = this.state.filteringSize.indexOf(size);\n        const newArray = [...this.state.filteringSize];\n        newArray.splice(colorIdx, 1);\n        this.setState({\n          filteringSize: newArray\n        }, () => this.filterQueryString());\n      })() : this.setState({\n        filteringSize: [...this.state.filteringSize, size]\n      }, () => this.filterQueryString());\n    };\n\n    this.filteringSilluet = silluetEngName => {\n      this.state.filteringSilluet.includes(silluetEngName) ? (() => {\n        let colorIdx = this.state.filteringSilluet.indexOf(silluetEngName);\n        const newArray = [...this.state.filteringSilluet];\n        newArray.splice(colorIdx, 1);\n        this.setState({\n          filteringSilluet: newArray\n        }, () => this.filterQueryString());\n      })() : this.setState({\n        filteringSilluet: [...this.state.filteringSilluet, silluetEngName]\n      }, () => this.filterQueryString());\n    };\n\n    this.state = {\n      wholeProducts: [],\n      products: [],\n      hideFilterVaild: false,\n      loadingStatus: false,\n      ProductMainImage: {\n        MainImg: []\n      },\n      filteringColor: [],\n      filteringSize: [],\n      filteringSilluet: [],\n      queryId: this.props.location.search.split(\"=\")[1]\n    };\n  }\n\n  componentDidMount() {\n    this.getDataInitial();\n  }\n\n  render() {\n    const {\n      wholeProducts,\n      products,\n      hideFilterVaild,\n      loadingStatus,\n      ProductMainImage,\n      queryId\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ProductList\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: loadingStatus ? \"loadingImageValid\" : \"loadingImageUnvalid\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      alt: \"loadingImg\",\n      src: \"/images/productList/preloader.gif\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(PromoBanner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Nav, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"header\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"shoesTitle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 11\n      }\n    }, HeaderImg.HeaderImg[queryId - 1].categoryName), /*#__PURE__*/React.createElement(\"img\", {\n      alt: \"headerImges\",\n      src: HeaderImg.HeaderImg[queryId - 1].imgUrl,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(FilterHorizontalBar, {\n      hideFilterValid: hideFilterVaild,\n      handleFilter: this.handleFilter,\n      cnt: wholeProducts.length,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"bottomOfPage\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: hideFilterVaild ? \"hideVerticalFilterValild\" : \"hideVerticalFilterUnvalild\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(FilterVerticalBar, {\n      filteringColor: Color => this.filteringColor(Color),\n      filteringSize: size => this.filteringSize(size),\n      filteringSilluet: silluetEngName => this.filteringSilluet(silluetEngName),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"main\", {\n      className: hideFilterVaild ? \"HideProductListMain\" : \"ProductListMain\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 11\n      }\n    }, products.length > 0 && products.map((product, pdIdx) => {\n      const {\n        id,\n        image_url,\n        series_name,\n        price\n      } = product.main_image;\n      const {\n        color_image\n      } = product;\n      ProductMainImage.MainImg.push({\n        idx: pdIdx,\n        mainId: id,\n        ImgUrl: image_url\n      });\n      return /*#__PURE__*/React.createElement(ProductContainer, {\n        key: pdIdx,\n        hideFilterValid: hideFilterVaild,\n        mainId: id,\n        imgUrl: ProductMainImage.MainImg[pdIdx].ImgUrl,\n        name: series_name,\n        price: price,\n        colorList: color_image,\n        fixedImage: colorEl => this.fixedImage(colorEl, pdIdx),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 19\n        }\n      });\n    }))), /*#__PURE__*/React.createElement(Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\nexport default withRouter(ProductList);","map":{"version":3,"sources":["/home/user/바탕화면/wecode/project/converse/12-Allstar-frontend/src/Pages/ProductList/ProductList.js"],"names":["React","withRouter","FilterVerticalBar","ProductContainer","FilterHorizontalBar","Footer","PromoBanner","Nav","HeaderImg","ProductList","Component","constructor","props","getDataInitial","window","onbeforeunload","scrollTo","categoryId","location","search","split","setState","loadingStatus","state","products","ProductMainImage","MainImg","fetch","then","res","json","result","slice","length","setTimeout","wholeProducts","addEventListener","infiniteScroll","e","scrollHeight","Math","max","document","documentElement","body","scrollTop","clientHeight","pagination","preventDefault","keys","wheelOpt","supportsPassive","passive","wheelEvent","createElement","preventDefaultForScrollKeys","keyCode","removeEventListener","filterQueryString","filteringQueryStringApi","filteringColor","map","color","join","filteringSize","size","filteringSilluet","silluet","getfilteringData","console","log","fixedImage","colorEl","pdIdx","updateProductMainImage","mainId","id","ImgUrl","image_url","handleFilter","hideFilterVaild","Color","includes","colorIdx","indexOf","newArray","splice","silluetEngName","queryId","componentDidMount","render","categoryName","imgUrl","product","series_name","price","main_image","color_image","push","idx"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,OAAOC,iBAAP,MAA8B,kDAA9B;AACA,OAAOC,gBAAP,MAA6B,gDAA7B;AACA,OAAOC,mBAAP,MAAgC,sDAAhC;AACA,OAAOC,MAAP,MAAmB,gCAAnB;AACA,OAAOC,WAAP,MAAwB,0CAAxB;AACA,OAAOC,GAAP,MAAgB,0BAAhB;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAO,oBAAP;AAEA,OAAO,MAAMC,WAAN,SAA0BT,KAAK,CAACU,SAAhC,CAA0C;AAC/CC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAenBC,cAfmB,GAeF,MAAM;AACrBC,MAAAA,MAAM,CAACC,cAAP,GAAwB,MAAM;AAC5BD,QAAAA,MAAM,CAACE,QAAP,CAAgB,CAAhB,EAAmB,CAAnB;AACD,OAFD;;AAIA,YAAMC,UAAU,GAAG,KAAKL,KAAL,CAAWM,QAAX,CAAoBC,MAApB,CAA2BC,KAA3B,CAAiC,GAAjC,EAAsC,CAAtC,CAAnB;AACA,WAAKC,QAAL,CACE;AACEC,QAAAA,aAAa,EAAE,CAAC,KAAKC,KAAL,CAAWD,aAD7B;AAEEE,QAAAA,QAAQ,EAAE,EAFZ;AAGEC,QAAAA,gBAAgB,EAAE;AAAEC,UAAAA,OAAO,EAAE;AAAX;AAHpB,OADF,EAME,MAAM;AACJ;AACAC,QAAAA,KAAK,CAAE,oDAAmDV,UAAW,EAAhE,CAAL,CACGW,IADH,CACSC,GAAD,IAASA,GAAG,CAACC,IAAJ,EADjB,EAEGF,IAFH,CAESC,GAAD,IAAS;AACb;AACA,cAAIE,MAAM,GAAGF,GAAG,CAACL,QAAJ,CAAaQ,KAAb,CACX,KAAKT,KAAL,CAAWC,QAAX,CAAoBS,MADT,EAEX,KAAKV,KAAL,CAAWC,QAAX,CAAoBS,MAApB,GAA6B,EAFlB,CAAb,CAFa,CAOb;;AACAC,UAAAA,UAAU,CACR,MACE,KAAKb,QAAL,CACE;AACEC,YAAAA,aAAa,EAAE,CAAC,KAAKC,KAAL,CAAWD;AAD7B,WADF,EAIE,MAAM;AACJ,iBAAKD,QAAL,CAAc;AACZc,cAAAA,aAAa,EAAEN,GAAG,CAACL,QADP;AAEZA,cAAAA,QAAQ,EAAE,CAAC,GAAG,KAAKD,KAAL,CAAWC,QAAf,EAAyB,GAAGO,MAA5B;AAFE,aAAd;AAID,WATH,CAFM,EAaR,IAbQ,CAAV;AAeAjB,UAAAA,MAAM,CAACsB,gBAAP,CAAwB,QAAxB,EAAkC,KAAKC,cAAvC;AACD,SA1BH;AA2BD,OAnCH;AAqCD,KA1DkB;;AAAA,SA4DnBA,cA5DmB,GA4DDC,CAAD,IAAO;AACtB,UAAIC,YAAY,GAAGC,IAAI,CAACC,GAAL,CACjBC,QAAQ,CAACC,eAAT,CAAyBJ,YADR,EAEjBG,QAAQ,CAACE,IAAT,CAAcL,YAFG,CAAnB;AAIA,UAAIM,SAAS,GAAGL,IAAI,CAACC,GAAL,CACdC,QAAQ,CAACC,eAAT,CAAyBE,SADX,EAEdH,QAAQ,CAACE,IAAT,CAAcC,SAFA,CAAhB;AAIA,UAAIC,YAAY,GAAGJ,QAAQ,CAACC,eAAT,CAAyBG,YAA5C;;AAEA,UAAID,SAAS,GAAGC,YAAZ,GAA2B,GAA3B,IAAkCP,YAAtC,EAAoD;AAClD,aAAKQ,UAAL;AACAT,QAAAA,CAAC,CAACU,cAAF;AACD;AACF,KA3EkB;;AAAA,SA6EnBD,UA7EmB,GA6EN,MAAM;AACjB,UAAIE,IAAI,GAAG;AAAE,YAAI,CAAN;AAAS,YAAI,CAAb;AAAgB,YAAI,CAApB;AAAuB,YAAI;AAA3B,OAAX;AACA,UAAIC,QAAQ,GAAGC,eAAe,GAAG;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAAH,GAAwB,KAAtD;AACA,UAAIC,UAAU,GACZ,aAAaX,QAAQ,CAACY,aAAT,CAAuB,KAAvB,CAAb,GAA6C,OAA7C,GAAuD,YADzD;;AAGA,eAASN,cAAT,CAAwBV,CAAxB,EAA2B;AACzBA,QAAAA,CAAC,CAACU,cAAF;AACD;;AAED,eAASO,2BAAT,CAAqCjB,CAArC,EAAwC;AACtC,YAAIW,IAAI,CAACX,CAAC,CAACkB,OAAH,CAAR,EAAqB;AACnBR,UAAAA,cAAc,CAACV,CAAD,CAAd;AACA,iBAAO,KAAP;AACD;AACF;;AAEDxB,MAAAA,MAAM,CAACsB,gBAAP,CAAwBiB,UAAxB,EAAoCL,cAApC,EAAoDE,QAApD;AAEA,YAAM;AAAEf,QAAAA,aAAF;AAAiBX,QAAAA;AAAjB,UAA8B,KAAKD,KAAzC;;AACA,UAAIY,aAAa,CAACF,MAAd,GAAuBT,QAAQ,CAACS,MAApC,EAA4C;AAC1C,aAAKZ,QAAL,CACE;AACEC,UAAAA,aAAa,EAAE,CAAC,KAAKC,KAAL,CAAWD;AAD7B,SADF,EAIE,MAAM;AACJ,cAAIS,MAAM,GAAGI,aAAa,CAACH,KAAd,CACXR,QAAQ,CAACS,MADE,EAEXT,QAAQ,CAACS,MAAT,GAAkB,EAFP,CAAb;AAKAC,UAAAA,UAAU,CACR,MACE,KAAKb,QAAL,CACE;AACEC,YAAAA,aAAa,EAAE,CAAC,KAAKC,KAAL,CAAWD;AAD7B,WADF,EAIE,MAAM;AACJ,iBAAKD,QAAL,CACE;AACEG,cAAAA,QAAQ,EAAE,CAAC,GAAG,KAAKD,KAAL,CAAWC,QAAf,EAAyB,GAAGO,MAA5B;AADZ,aADF,EAIE,MAAM;AACJjB,cAAAA,MAAM,CAAC2C,mBAAP,CACEJ,UADF,EAEEL,cAFF,EAGEE,QAHF;AAKD,aAVH;AAYD,WAjBH,CAFM,EAqBR,IArBQ,CAAV;AAuBD,SAjCH;AAmCD;AACF,KAtIkB;;AAAA,SAwInBQ,iBAxImB,GAwIC,MAAM;AACxB,YAAMzC,UAAU,GAAG,KAAKL,KAAL,CAAWM,QAAX,CAAoBC,MAApB,CAA2BC,KAA3B,CAAiC,GAAjC,EAAsC,CAAtC,CAAnB;AACA,UAAIuC,uBAAuB,GAAI,oDAAmD1C,UAAW,IAC3F,KAAKM,KAAL,CAAWqC,cAAX,GACI,KAAKrC,KAAL,CAAWqC,cAAX,CACGC,GADH,CACQC,KAAD,IAAW;AACd,eAAQ,SAAQA,KAAM,GAAtB;AACD,OAHH,EAIGC,IAJH,CAIQ,EAJR,CADJ,GAMI,EACL,GACC,KAAKxC,KAAL,CAAWyC,aAAX,GACI,KAAKzC,KAAL,CAAWyC,aAAX,CACGH,GADH,CACQI,IAAD,IAAU;AACb,eAAQ,QAAOA,IAAK,GAApB;AACD,OAHH,EAIGF,IAJH,CAIQ,EAJR,CADJ,GAMI,EACL,GACC,KAAKxC,KAAL,CAAW2C,gBAAX,GACI,KAAK3C,KAAL,CAAW2C,gBAAX,CACGL,GADH,CACQM,OAAD,IAAa;AAChB,eAAQ,aAAYA,OAAQ,GAA5B;AACD,OAHH,EAIGJ,IAJH,CAIQ,EAJR,CADJ,GAMI,EACL,EAxB6B,CAwB3B/B,KAxB2B,CAwBrB,CAxBqB,EAwBlB,CAAC,CAxBiB,CAA9B;AAyBA,WAAKoC,gBAAL,CAAsBT,uBAAtB;AACAU,MAAAA,OAAO,CAACC,GAAR,CAAYX,uBAAZ;AACD,KArKkB;;AAAA,SAuKnBS,gBAvKmB,GAuKCT,uBAAD,IAA6B;AAC9C7C,MAAAA,MAAM,CAACC,cAAP,GAAwB,MAAM;AAC5BD,QAAAA,MAAM,CAACE,QAAP,CAAgB,CAAhB,EAAmB,CAAnB;AACD,OAFD;;AAIA,WAAKK,QAAL,CACE;AACEC,QAAAA,aAAa,EAAE,CAAC,KAAKC,KAAL,CAAWD,aAD7B;AAEEE,QAAAA,QAAQ,EAAE,EAFZ;AAGEC,QAAAA,gBAAgB,EAAE;AAAEC,UAAAA,OAAO,EAAE;AAAX;AAHpB,OADF,EAME,MAAM;AACJC,QAAAA,KAAK,CAACgC,uBAAD,CAAL,CACG/B,IADH,CACSC,GAAD,IAASA,GAAG,CAACC,IAAJ,EADjB,EAEGF,IAFH,CAESC,GAAD,IAAS;AACbwC,UAAAA,OAAO,CAACC,GAAR,CAAYzC,GAAZ;AACA,cAAIE,MAAM,GAAGF,GAAG,CAACL,QAAJ,CAAaQ,KAAb,CACX,KAAKT,KAAL,CAAWC,QAAX,CAAoBS,MADT,EAEX,KAAKV,KAAL,CAAWC,QAAX,CAAoBS,MAApB,GAA6B,EAFlB,CAAb;AAIAC,UAAAA,UAAU,CACR,MACE,KAAKb,QAAL,CACE;AACEC,YAAAA,aAAa,EAAE,CAAC,KAAKC,KAAL,CAAWD;AAD7B,WADF,EAIE,MAAM;AACJ,iBAAKD,QAAL,CAAc;AACZc,cAAAA,aAAa,EAAEN,GAAG,CAACL,QADP;AAEZA,cAAAA,QAAQ,EAAEO;AAFE,aAAd;AAID,WATH,CAFM,EAaR,IAbQ,CAAV;AAeAjB,UAAAA,MAAM,CAACsB,gBAAP,CAAwB,QAAxB,EAAkC,KAAKC,cAAvC;AACD,SAxBH;AAyBD,OAhCH;AAkCD,KA9MkB;;AAAA,SAgNnBkC,UAhNmB,GAgNN,CAACC,OAAD,EAAUC,KAAV,KAAoB;AAC/B,UAAIC,sBAAsB,GAAG,KAAKnD,KAAL,CAAWE,gBAAxC;AACAiD,MAAAA,sBAAsB,CAAChD,OAAvB,CAA+B+C,KAA/B,EAAsCE,MAAtC,GAA+CH,OAAO,CAACI,EAAvD;AACAF,MAAAA,sBAAsB,CAAChD,OAAvB,CAA+B+C,KAA/B,EAAsCI,MAAtC,GAA+CL,OAAO,CAACM,SAAvD;AACA,WAAKzD,QAAL,CAAc;AACZI,QAAAA,gBAAgB,EAAEiD;AADN,OAAd;AAGD,KAvNkB;;AAAA,SAyNnBK,YAzNmB,GAyNJ,MAAM;AACnB,WAAK1D,QAAL,CAAc;AACZ2D,QAAAA,eAAe,EAAE,CAAC,KAAKzD,KAAL,CAAWyD;AADjB,OAAd;AAGD,KA7NkB;;AAAA,SA+NnBpB,cA/NmB,GA+NDqB,KAAD,IAAW;AAC1B,WAAK1D,KAAL,CAAWqC,cAAX,CAA0BsB,QAA1B,CAAmCD,KAAnC,IACI,CAAC,MAAM;AACL,YAAIE,QAAQ,GAAG,KAAK5D,KAAL,CAAWqC,cAAX,CAA0BwB,OAA1B,CAAkCH,KAAlC,CAAf;AACA,cAAMI,QAAQ,GAAG,CAAC,GAAG,KAAK9D,KAAL,CAAWqC,cAAf,CAAjB;AACAyB,QAAAA,QAAQ,CAACC,MAAT,CAAgBH,QAAhB,EAA0B,CAA1B;AACA,aAAK9D,QAAL,CACE;AACEuC,UAAAA,cAAc,EAAEyB;AADlB,SADF,EAIE,MAAM,KAAK3B,iBAAL,EAJR;AAMD,OAVD,GADJ,GAYI,KAAKrC,QAAL,CACE;AACEuC,QAAAA,cAAc,EAAE,CAAC,GAAG,KAAKrC,KAAL,CAAWqC,cAAf,EAA+BqB,KAA/B;AADlB,OADF,EAIE,MAAM,KAAKvB,iBAAL,EAJR,CAZJ;AAkBD,KAlPkB;;AAAA,SAoPnBM,aApPmB,GAoPFC,IAAD,IAAU;AACxB,WAAK1C,KAAL,CAAWyC,aAAX,CAAyBkB,QAAzB,CAAkCjB,IAAlC,IACI,CAAC,MAAM;AACL,YAAIkB,QAAQ,GAAG,KAAK5D,KAAL,CAAWyC,aAAX,CAAyBoB,OAAzB,CAAiCnB,IAAjC,CAAf;AACA,cAAMoB,QAAQ,GAAG,CAAC,GAAG,KAAK9D,KAAL,CAAWyC,aAAf,CAAjB;AACAqB,QAAAA,QAAQ,CAACC,MAAT,CAAgBH,QAAhB,EAA0B,CAA1B;AACA,aAAK9D,QAAL,CACE;AACE2C,UAAAA,aAAa,EAAEqB;AADjB,SADF,EAIE,MAAM,KAAK3B,iBAAL,EAJR;AAMD,OAVD,GADJ,GAYI,KAAKrC,QAAL,CACE;AACE2C,QAAAA,aAAa,EAAE,CAAC,GAAG,KAAKzC,KAAL,CAAWyC,aAAf,EAA8BC,IAA9B;AADjB,OADF,EAIE,MAAM,KAAKP,iBAAL,EAJR,CAZJ;AAkBD,KAvQkB;;AAAA,SAyQnBQ,gBAzQmB,GAyQCqB,cAAD,IAAoB;AACrC,WAAKhE,KAAL,CAAW2C,gBAAX,CAA4BgB,QAA5B,CAAqCK,cAArC,IACI,CAAC,MAAM;AACL,YAAIJ,QAAQ,GAAG,KAAK5D,KAAL,CAAW2C,gBAAX,CAA4BkB,OAA5B,CAAoCG,cAApC,CAAf;AACA,cAAMF,QAAQ,GAAG,CAAC,GAAG,KAAK9D,KAAL,CAAW2C,gBAAf,CAAjB;AACAmB,QAAAA,QAAQ,CAACC,MAAT,CAAgBH,QAAhB,EAA0B,CAA1B;AACA,aAAK9D,QAAL,CACE;AACE6C,UAAAA,gBAAgB,EAAEmB;AADpB,SADF,EAIE,MAAM,KAAK3B,iBAAL,EAJR;AAMD,OAVD,GADJ,GAYI,KAAKrC,QAAL,CACE;AACE6C,QAAAA,gBAAgB,EAAE,CAAC,GAAG,KAAK3C,KAAL,CAAW2C,gBAAf,EAAiCqB,cAAjC;AADpB,OADF,EAIE,MAAM,KAAK7B,iBAAL,EAJR,CAZJ;AAkBD,KA5RkB;;AAEjB,SAAKnC,KAAL,GAAa;AACXY,MAAAA,aAAa,EAAE,EADJ;AAEXX,MAAAA,QAAQ,EAAE,EAFC;AAGXwD,MAAAA,eAAe,EAAE,KAHN;AAIX1D,MAAAA,aAAa,EAAE,KAJJ;AAKXG,MAAAA,gBAAgB,EAAE;AAAEC,QAAAA,OAAO,EAAE;AAAX,OALP;AAMXkC,MAAAA,cAAc,EAAE,EANL;AAOXI,MAAAA,aAAa,EAAE,EAPJ;AAQXE,MAAAA,gBAAgB,EAAE,EARP;AASXsB,MAAAA,OAAO,EAAE,KAAK5E,KAAL,CAAWM,QAAX,CAAoBC,MAApB,CAA2BC,KAA3B,CAAiC,GAAjC,EAAsC,CAAtC;AATE,KAAb;AAWD;;AAiRDqE,EAAAA,iBAAiB,GAAG;AAClB,SAAK5E,cAAL;AACD;;AAED6E,EAAAA,MAAM,GAAG;AACP,UAAM;AACJvD,MAAAA,aADI;AAEJX,MAAAA,QAFI;AAGJwD,MAAAA,eAHI;AAIJ1D,MAAAA,aAJI;AAKJG,MAAAA,gBALI;AAMJ+D,MAAAA;AANI,QAOF,KAAKjE,KAPT;AAQA,wBACE;AAAK,MAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,MAAA,SAAS,EACPD,aAAa,GAAG,mBAAH,GAAyB,qBAF1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAKE;AAAK,MAAA,GAAG,EAAC,YAAT;AAAsB,MAAA,GAAG,EAAC,mCAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALF,CADF,eAQE,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MARF,eASE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MATF,eAUE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAM,MAAA,SAAS,EAAC,YAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGd,SAAS,CAACA,SAAV,CAAoBgF,OAAO,GAAG,CAA9B,EAAiCG,YADpC,CADF,eAIE;AACE,MAAA,GAAG,EAAC,aADN;AAEE,MAAA,GAAG,EAAEnF,SAAS,CAACA,SAAV,CAAoBgF,OAAO,GAAG,CAA9B,EAAiCI,MAFxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJF,CAVF,eAmBE,oBAAC,mBAAD;AACE,MAAA,eAAe,EAAEZ,eADnB;AAEE,MAAA,YAAY,EAAE,KAAKD,YAFrB;AAGE,MAAA,GAAG,EAAE5C,aAAa,CAACF,MAHrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAnBF,eAwBE;AAAK,MAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,MAAA,SAAS,EACP+C,eAAe,GACX,0BADW,GAEX,4BAJR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAOE,oBAAC,iBAAD;AACE,MAAA,cAAc,EAAGC,KAAD,IAAW,KAAKrB,cAAL,CAAoBqB,KAApB,CAD7B;AAEE,MAAA,aAAa,EAAGhB,IAAD,IAAU,KAAKD,aAAL,CAAmBC,IAAnB,CAF3B;AAGE,MAAA,gBAAgB,EAAGsB,cAAD,IAChB,KAAKrB,gBAAL,CAAsBqB,cAAtB,CAJJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,CADF,eAgBE;AACE,MAAA,SAAS,EACPP,eAAe,GAAG,qBAAH,GAA2B,iBAF9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAKGxD,QAAQ,CAACS,MAAT,GAAkB,CAAlB,IACCT,QAAQ,CAACqC,GAAT,CAAa,CAACgC,OAAD,EAAUpB,KAAV,KAAoB;AAC/B,YAAM;AACJG,QAAAA,EADI;AAEJE,QAAAA,SAFI;AAGJgB,QAAAA,WAHI;AAIJC,QAAAA;AAJI,UAKFF,OAAO,CAACG,UALZ;AAMA,YAAM;AAAEC,QAAAA;AAAF,UAAkBJ,OAAxB;AACApE,MAAAA,gBAAgB,CAACC,OAAjB,CAAyBwE,IAAzB,CAA8B;AAC5BC,QAAAA,GAAG,EAAE1B,KADuB;AAE5BE,QAAAA,MAAM,EAAEC,EAFoB;AAG5BC,QAAAA,MAAM,EAAEC;AAHoB,OAA9B;AAKA,0BACE,oBAAC,gBAAD;AACE,QAAA,GAAG,EAAEL,KADP;AAEE,QAAA,eAAe,EAAEO,eAFnB;AAGE,QAAA,MAAM,EAAEJ,EAHV;AAIE,QAAA,MAAM,EAAEnD,gBAAgB,CAACC,OAAjB,CAAyB+C,KAAzB,EAAgCI,MAJ1C;AAKE,QAAA,IAAI,EAAEiB,WALR;AAME,QAAA,KAAK,EAAEC,KANT;AAOE,QAAA,SAAS,EAAEE,WAPb;AAQE,QAAA,UAAU,EAAGzB,OAAD,IAAa,KAAKD,UAAL,CAAgBC,OAAhB,EAAyBC,KAAzB,CAR3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AAYD,KAzBD,CANJ,CAhBF,CAxBF,eA2EE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA3EF,CADF;AA+ED;;AA3X8C;AA8XjD,eAAexE,UAAU,CAACQ,WAAD,CAAzB","sourcesContent":["import React from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport FilterVerticalBar from \"./Components/FilterVerticalBar/FilterVerticalBar\";\nimport ProductContainer from \"./Components/ProductContainer/ProductContainer\";\nimport FilterHorizontalBar from \"./Components/FilterHorizontalBar/FilterHorizontalBar\";\nimport Footer from \"../../Components/Footer/Footer\";\nimport PromoBanner from \"../../Components/PromoBanner/PromoBanner\";\nimport Nav from \"../../Components/Nav/Nav\";\nimport HeaderImg from \"./HeaderImg\";\nimport \"./ProductList.scss\";\n\nexport class ProductList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      wholeProducts: [],\n      products: [],\n      hideFilterVaild: false,\n      loadingStatus: false,\n      ProductMainImage: { MainImg: [] },\n      filteringColor: [],\n      filteringSize: [],\n      filteringSilluet: [],\n      queryId: this.props.location.search.split(\"=\")[1],\n    };\n  }\n\n  getDataInitial = () => {\n    window.onbeforeunload = () => {\n      window.scrollTo(0, 0);\n    };\n\n    const categoryId = this.props.location.search.split(\"=\")[1];\n    this.setState(\n      {\n        loadingStatus: !this.state.loadingStatus,\n        products: [],\n        ProductMainImage: { MainImg: [] },\n      },\n      () => {\n        // fetch(\"/data/ProductList/Products.json\")\n        fetch(`http://10.58.1.230:8000/products?sub_category_id=${categoryId}`)\n          .then((res) => res.json())\n          .then((res) => {\n            // 무한스크롤 기능 확인을 위한 임의 함수\n            let result = res.products.slice(\n              this.state.products.length,\n              this.state.products.length + 14\n            );\n\n            // let result = res.products;\n            setTimeout(\n              () =>\n                this.setState(\n                  {\n                    loadingStatus: !this.state.loadingStatus,\n                  },\n                  () => {\n                    this.setState({\n                      wholeProducts: res.products,\n                      products: [...this.state.products, ...result],\n                    });\n                  }\n                ),\n              1000\n            );\n            window.addEventListener(\"scroll\", this.infiniteScroll);\n          });\n      }\n    );\n  };\n\n  infiniteScroll = (e) => {\n    let scrollHeight = Math.max(\n      document.documentElement.scrollHeight,\n      document.body.scrollHeight\n    );\n    let scrollTop = Math.max(\n      document.documentElement.scrollTop,\n      document.body.scrollTop\n    );\n    let clientHeight = document.documentElement.clientHeight;\n\n    if (scrollTop + clientHeight + 500 >= scrollHeight) {\n      this.pagination();\n      e.preventDefault();\n    }\n  };\n\n  pagination = () => {\n    var keys = { 37: 1, 38: 1, 39: 1, 40: 1 };\n    var wheelOpt = supportsPassive ? { passive: false } : false;\n    var wheelEvent =\n      \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : \"mousewheel\";\n\n    function preventDefault(e) {\n      e.preventDefault();\n    }\n\n    function preventDefaultForScrollKeys(e) {\n      if (keys[e.keyCode]) {\n        preventDefault(e);\n        return false;\n      }\n    }\n\n    window.addEventListener(wheelEvent, preventDefault, wheelOpt);\n\n    const { wholeProducts, products } = this.state;\n    if (wholeProducts.length > products.length) {\n      this.setState(\n        {\n          loadingStatus: !this.state.loadingStatus,\n        },\n        () => {\n          let result = wholeProducts.slice(\n            products.length,\n            products.length + 14\n          );\n\n          setTimeout(\n            () =>\n              this.setState(\n                {\n                  loadingStatus: !this.state.loadingStatus,\n                },\n                () => {\n                  this.setState(\n                    {\n                      products: [...this.state.products, ...result],\n                    },\n                    () => {\n                      window.removeEventListener(\n                        wheelEvent,\n                        preventDefault,\n                        wheelOpt\n                      );\n                    }\n                  );\n                }\n              ),\n            1000\n          );\n        }\n      );\n    }\n  };\n\n  filterQueryString = () => {\n    const categoryId = this.props.location.search.split(\"=\")[1];\n    let filteringQueryStringApi = `http://10.58.1.230:8000/products?sub_category_id=${categoryId}&${\n      this.state.filteringColor\n        ? this.state.filteringColor\n            .map((color) => {\n              return `color=${color}&`;\n            })\n            .join(\"\")\n        : \"\"\n    }${\n      this.state.filteringSize\n        ? this.state.filteringSize\n            .map((size) => {\n              return `size=${size}&`;\n            })\n            .join(\"\")\n        : \"\"\n    }${\n      this.state.filteringSilluet\n        ? this.state.filteringSilluet\n            .map((silluet) => {\n              return `silouette=${silluet}&`;\n            })\n            .join(\"\")\n        : \"\"\n    }`.slice(0, -1);\n    this.getfilteringData(filteringQueryStringApi);\n    console.log(filteringQueryStringApi);\n  };\n\n  getfilteringData = (filteringQueryStringApi) => {\n    window.onbeforeunload = () => {\n      window.scrollTo(0, 0);\n    };\n\n    this.setState(\n      {\n        loadingStatus: !this.state.loadingStatus,\n        products: [],\n        ProductMainImage: { MainImg: [] },\n      },\n      () => {\n        fetch(filteringQueryStringApi)\n          .then((res) => res.json())\n          .then((res) => {\n            console.log(res);\n            let result = res.products.slice(\n              this.state.products.length,\n              this.state.products.length + 14\n            );\n            setTimeout(\n              () =>\n                this.setState(\n                  {\n                    loadingStatus: !this.state.loadingStatus,\n                  },\n                  () => {\n                    this.setState({\n                      wholeProducts: res.products,\n                      products: result,\n                    });\n                  }\n                ),\n              1000\n            );\n            window.addEventListener(\"scroll\", this.infiniteScroll);\n          });\n      }\n    );\n  };\n\n  fixedImage = (colorEl, pdIdx) => {\n    let updateProductMainImage = this.state.ProductMainImage;\n    updateProductMainImage.MainImg[pdIdx].mainId = colorEl.id;\n    updateProductMainImage.MainImg[pdIdx].ImgUrl = colorEl.image_url;\n    this.setState({\n      ProductMainImage: updateProductMainImage,\n    });\n  };\n\n  handleFilter = () => {\n    this.setState({\n      hideFilterVaild: !this.state.hideFilterVaild,\n    });\n  };\n\n  filteringColor = (Color) => {\n    this.state.filteringColor.includes(Color)\n      ? (() => {\n          let colorIdx = this.state.filteringColor.indexOf(Color);\n          const newArray = [...this.state.filteringColor];\n          newArray.splice(colorIdx, 1);\n          this.setState(\n            {\n              filteringColor: newArray,\n            },\n            () => this.filterQueryString()\n          );\n        })()\n      : this.setState(\n          {\n            filteringColor: [...this.state.filteringColor, Color],\n          },\n          () => this.filterQueryString()\n        );\n  };\n\n  filteringSize = (size) => {\n    this.state.filteringSize.includes(size)\n      ? (() => {\n          let colorIdx = this.state.filteringSize.indexOf(size);\n          const newArray = [...this.state.filteringSize];\n          newArray.splice(colorIdx, 1);\n          this.setState(\n            {\n              filteringSize: newArray,\n            },\n            () => this.filterQueryString()\n          );\n        })()\n      : this.setState(\n          {\n            filteringSize: [...this.state.filteringSize, size],\n          },\n          () => this.filterQueryString()\n        );\n  };\n\n  filteringSilluet = (silluetEngName) => {\n    this.state.filteringSilluet.includes(silluetEngName)\n      ? (() => {\n          let colorIdx = this.state.filteringSilluet.indexOf(silluetEngName);\n          const newArray = [...this.state.filteringSilluet];\n          newArray.splice(colorIdx, 1);\n          this.setState(\n            {\n              filteringSilluet: newArray,\n            },\n            () => this.filterQueryString()\n          );\n        })()\n      : this.setState(\n          {\n            filteringSilluet: [...this.state.filteringSilluet, silluetEngName],\n          },\n          () => this.filterQueryString()\n        );\n  };\n\n  componentDidMount() {\n    this.getDataInitial();\n  }\n\n  render() {\n    const {\n      wholeProducts,\n      products,\n      hideFilterVaild,\n      loadingStatus,\n      ProductMainImage,\n      queryId,\n    } = this.state;\n    return (\n      <div className=\"ProductList\">\n        <div\n          className={\n            loadingStatus ? \"loadingImageValid\" : \"loadingImageUnvalid\"\n          }\n        >\n          <img alt=\"loadingImg\" src=\"/images/productList/preloader.gif\" />\n        </div>\n        <PromoBanner />\n        <Nav />\n        <header>\n          <span className=\"shoesTitle\">\n            {HeaderImg.HeaderImg[queryId - 1].categoryName}\n          </span>\n          <img\n            alt=\"headerImges\"\n            src={HeaderImg.HeaderImg[queryId - 1].imgUrl}\n          />\n        </header>\n        <FilterHorizontalBar\n          hideFilterValid={hideFilterVaild}\n          handleFilter={this.handleFilter}\n          cnt={wholeProducts.length}\n        />\n        <div className=\"bottomOfPage\">\n          <div\n            className={\n              hideFilterVaild\n                ? \"hideVerticalFilterValild\"\n                : \"hideVerticalFilterUnvalild\"\n            }\n          >\n            <FilterVerticalBar\n              filteringColor={(Color) => this.filteringColor(Color)}\n              filteringSize={(size) => this.filteringSize(size)}\n              filteringSilluet={(silluetEngName) =>\n                this.filteringSilluet(silluetEngName)\n              }\n            />\n          </div>\n          <main\n            className={\n              hideFilterVaild ? \"HideProductListMain\" : \"ProductListMain\"\n            }\n          >\n            {products.length > 0 &&\n              products.map((product, pdIdx) => {\n                const {\n                  id,\n                  image_url,\n                  series_name,\n                  price,\n                } = product.main_image;\n                const { color_image } = product;\n                ProductMainImage.MainImg.push({\n                  idx: pdIdx,\n                  mainId: id,\n                  ImgUrl: image_url,\n                });\n                return (\n                  <ProductContainer\n                    key={pdIdx}\n                    hideFilterValid={hideFilterVaild}\n                    mainId={id}\n                    imgUrl={ProductMainImage.MainImg[pdIdx].ImgUrl}\n                    name={series_name}\n                    price={price}\n                    colorList={color_image}\n                    fixedImage={(colorEl) => this.fixedImage(colorEl, pdIdx)}\n                  />\n                );\n              })}\n          </main>\n        </div>\n        {/* <footer>footer 컴포넌트 예정</footer> */}\n        <Footer />\n      </div>\n    );\n  }\n}\n\nexport default withRouter(ProductList);\n"]},"metadata":{},"sourceType":"module"}